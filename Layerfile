#Use an Ubuntu 18.04 base for our staging server
FROM vm/ubuntu:18.04

RUN apt-get update && apt-get install -y curl unzip
RUN curl -fsSL https://deno.land/install.sh | sh

ENV DENO_INSTALL="/root/.deno"
ENV PATH="$DENO_INSTALL/bin:$PATH"

COPY . /app
WORKDIR /app

RUN deno run --allow-net --allow-read --unstable app-run.js


# Expose the webserver in the staging server as a secure link.
# Whenever someone clicks the link, we'll load this staging server and forward
# their requests to it.
RUN BACKGROUND python3 -m http.server 80
EXPOSE WEBSITE http://localhost:80


